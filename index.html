<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Vibrant.js example</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="libraries/vibrant.js"></script>

  </head>
  <style>
.column {
  float: left;
  width: 33.33%;
  align-items: end;
}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}
svg{
    transform: rotateX(45deg) rotateY(0deg) rotateZ(45deg);

}
#loading {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        button {
            width: 300px;
            height: 200px;
  border: none; /* No borders */
  padding: 15px 32px; /* Padding around the text */
  text-align: center; /* Centered text */
  text-decoration: none; /* No underline on the text */
  display: inline-block; /* Inline block level element */
  margin: 4px 2px; /* Margins around the button */
  cursor: pointer; /* Pointer cursor on hover */
  border-radius: 4px; /* Rounded corners */
}

/* Add a hover effect for buttons */
button:hover {
  background-color: #45a049; /* Darker green background on hover */
}


  </style>
  <body>
    <!-- <div id="loading">Loading...</div> -->

    <section id="intro">
        <div class="intro-content">
            <div id="header">
            <h1>The discover of National Gallery of Art</h1>
        </div>
            <h4>Discover how Citibike is used across Manhattan's diverse landscapes.</h4>
            <div id="view">
            <p>Select your view</p>
        </div>
            <div id="animation">
            <div id="lottie-animation"></div>
        </div>
            <div id="scroll">
                <h5>Scroll to explore</h5>
            </div>
        </div>
    </section>

<div class="row">
<div class="column" >
    <button id="svg-container1"></button>
</div>
<div class="column" >
    <button id="svg-container2"></button>
    <button id="svg-container3"></button>
    </div>
    <div class="column" >
        <button id="svg-container8"></button>
        <button id="svg-container7"></button>
        <button id="svg-container6"></button>
        <button id="svg-container5"></button>
        <button id="svg-container4"></button>
    </div>
</div>

<div id="dot-matrix-container">
    <h5>Proportion of Art types</h5>

    <svg width="300" height="180"></svg>
    <div id="legend"></div>
    <h6>Ground Floor: West Building</h6>
</div>

<script>
//Laoding page delay 3sec
// window.addEventListener('load', function () {
//     setTimeout(function() {
//         var loading = document.getElementById('loading');
//         loading.style.display = 'none';
//     }, 3000); 
// });
let selectedColors = []

// Function to get color by art type
function getColorByArtType(TypesofArt) {
    switch (TypesofArt) {
        case 'Sculpture':
            return 'red';
        case 'Painting':
            return 'blue';
        case 'Decorative Art':
            return 'green';
        case 'Drawing':
            return 'yellow';
        case 'New media':
            return 'pink';
        case 'Photograph':
            return 'purple';
        case 'Print':
            return 'grey';
        case 'Volume':
            return 'orange';
    }
}

// Function to show modal
function showModal(imageUrl, info, colors, site, description) {
        modalImage.src = imageUrl;
        modalInfo.innerHTML = info.replace(/\n/g, "<br>");

        let tagButtons = `<button class="tag-button" onclick="alert('${site}')">Site Tag</button>` +
                        `<button class="tag-button" onclick="alert('${description}')">Description Tag</button>`;

        modalInfo.innerHTML += tagButtons;

        let colorDivs = "<div>Your ingredients:</div>";
        colors.forEach(color => {
            colorDivs += `<div style="background-color: ${color}; width: 20px; height: 20px; margin: 5px;"></div>`;
        });
        document.getElementById("colorContainer").innerHTML = colorDivs;

        modal.style.display = "block";
    }

// Load the SVG file- Sculpture
d3.xml('SCULPTURE GARDEN.svg').then(svgData => {

const svgContainer = document.getElementById("svg-container1");
svgContainer.appendChild(svgData.documentElement);


d3.csv('Finaldata.csv').then(function(data) {
    data.forEach(function(d, index) {
        console.log("Room ID from CSV:", d.room); // ตรวจสอบข้อมูลจาก CSV
        const roomGroup = d3.select(`#${d.room}`);
        console.log("Selected Room Group:", roomGroup.node()); // ตรวจสอบว่าเลือก group ถูกต้องหรือไม่

        if (!roomGroup.empty()) {
            // Calculate the bounding box of the roomGroup
            const roomGroupElement = roomGroup.node(); // Get the DOM element
            const roomGroupBBox = roomGroupElement.getBBox();

            // Use the bounding box dimensions
            const roomGroupWidth = roomGroupBBox.width;
            const roomGroupHeight = roomGroupBBox.height;

            // Calculate random coordinates within the roomGroup
            const randomX = roomGroupBBox.x + Math.random() * roomGroupWidth;
            const randomY = roomGroupBBox.y + Math.random() * roomGroupHeight;

            Vibrant.from(d.iiifthumburl).getPalette(function(err, palette) {
                if (!err) {
                    let hexColorsForThisCircle = [];
                    for (const swatch in palette) {
                        if (palette[swatch] && typeof palette[swatch].getHex === 'function') {
                            hexColorsForThisCircle.push(palette[swatch].getHex());
                        }
                    }

                    // Append a circle to the selected group
                    let circle = roomGroup.append("circle")
                        .attr('cx', randomX)
                        .attr('cy', randomY)
                        .attr('r', 2)
                        .attr('fill', getColorByArtType(d.TypesofArt))
                        .attr('data-colors', hexColorsForThisCircle.join(', '))
                        .attr('data-art-type', d.TypesofArt)
                        .attr('data-site', d.site);
                        
                    console.log('Circle ID:', index, 'Colors:', hexColorsForThisCircle);


                    // Add click event to open the modal
                    circle.on("click", function() {
                        // Modal logic
                        const modal = document.getElementById("myModal");
                        const modalImage = document.getElementById("modalImage");
                        const modalInfo = document.getElementById("modalInfo");
                        const span = document.getElementsByClassName("close")[0];

                        // Set modal content
                        modalImage.src = d.iiifthumburl; // Load the image
                        modalInfo.textContent = `Room: ${d.room}\nArt Type: ${d.TypesofArt}\nColors: ${hexColorsForThisCircle.join(', ')}`;
                        circle.on("click", function() {
                        let modalInfo = `${d.title_x}\nby: ${d.forwarddisplayname}\nYear: ${d.displaydate_x}`;
                        let site = d.site;
                        let description = d.description;
                        showModal(d.iiifthumburl, modalInfo, hexColorsForThisCircle, site, description);
                    });
                        // Display the modal
                        modal.style.display = "block";

                        // Close modal when clicking the close button or outside the modal
                        span.onclick = function() {
                            modal.style.display = "none";
                        }

                        window.onclick = function(event) {
                            if (event.target == modal) {
                                modal.style.display = "none";
                            }
                        }
                    });

                    // Log the color data for this circle
                    console.log('Circle ID:', index, 'Colors:', hexColorsForThisCircle);
                } else {
                    console.error("Error at index", index, "with URL:", d.iiifthumburl, "Error:", err);
                }
            });
        } else {
            console.warn("Room group not found for", d.room);
        }
    });
});
});

// Load the SVG file- West main
d3.xml('West bd_ Ground flr_ Right.svg').then(svgData => {

const svgContainer = document.getElementById("svg-container2");
svgContainer.appendChild(svgData.documentElement);


d3.csv('Finaldata.csv').then(function(data) {
    data.forEach(function(d, index) {
        console.log("Room ID from CSV:", d.room); // ตรวจสอบข้อมูลจาก CSV
        const roomGroup = d3.select(`#${d.room}`);
        console.log("Selected Room Group:", roomGroup.node()); // ตรวจสอบว่าเลือก group ถูกต้องหรือไม่

        if (!roomGroup.empty()) {
            // Calculate the bounding box of the roomGroup
            const roomGroupElement = roomGroup.node(); // Get the DOM element
            const roomGroupBBox = roomGroupElement.getBBox();

            // Use the bounding box dimensions
            const roomGroupWidth = roomGroupBBox.width;
            const roomGroupHeight = roomGroupBBox.height;

            // Calculate random coordinates within the roomGroup
            const randomX = roomGroupBBox.x + Math.random() * roomGroupWidth;
            const randomY = roomGroupBBox.y + Math.random() * roomGroupHeight;

            Vibrant.from(d.iiifthumburl).getPalette(function(err, palette) {
                if (!err) {
                    let hexColorsForThisCircle = [];
                    for (const swatch in palette) {
                        if (palette[swatch] && typeof palette[swatch].getHex === 'function') {
                            hexColorsForThisCircle.push(palette[swatch].getHex());
                        }
                    }

                    // Append a circle to the selected group
                    let circle = roomGroup.append("circle")
                        .attr('cx', randomX)
                        .attr('cy', randomY)
                        .attr('r', 2)
                        .attr('fill', getColorByArtType(d.TypesofArt))
                        .attr('data-colors', hexColorsForThisCircle.join(', '))
                        .attr('data-art-type', d.TypesofArt)
                        .attr('data-site', d.site);
                        
                    console.log('Circle ID:', index, 'Colors:', hexColorsForThisCircle);


                    // Add click event to open the modal
                    circle.on("click", function() {
                        // Modal logic
                        const modal = document.getElementById("myModal");
                        const modalImage = document.getElementById("modalImage");
                        const modalInfo = document.getElementById("modalInfo");
                        const span = document.getElementsByClassName("close")[0];

                        // Set modal content
                        modalImage.src = d.iiifthumburl; // Load the image
                        modalInfo.textContent = `Room: ${d.room}\nArt Type: ${d.TypesofArt}\nColors: ${hexColorsForThisCircle.join(', ')}`;
                        circle.on("click", function() {
                        let modalInfo = `${d.title_x}\nby: ${d.forwarddisplayname}\nYear: ${d.displaydate_x}`;
                        let site = d.site;
                        let description = d.description;
                        showModal(d.iiifthumburl, modalInfo, hexColorsForThisCircle, site, description);
                    });
                        // Display the modal
                        modal.style.display = "block";

                        // Close modal when clicking the close button or outside the modal
                        span.onclick = function() {
                            modal.style.display = "none";
                        }

                        window.onclick = function(event) {
                            if (event.target == modal) {
                                modal.style.display = "none";
                            }
                        }
                    });

                    // Log the color data for this circle
                    console.log('Circle ID:', index, 'Colors:', hexColorsForThisCircle);
                } else {
                    console.error("Error at index", index, "with URL:", d.iiifthumburl, "Error:", err);
                }
            });
        } else {
            console.warn("Room group not found for", d.room);
        }
    });
});
});

// Load the SVG file- West ground
d3.xml('WEST-2.svg').then(svgData => {

const svgContainer = document.getElementById("svg-container3");
svgContainer.appendChild(svgData.documentElement);


d3.csv('Finaldata.csv').then(function(data) {
    data.forEach(function(d, index) {
        console.log("Room ID from CSV:", d.room); // ตรวจสอบข้อมูลจาก CSV
        const roomGroup = d3.select(`#${d.room}`);
        console.log("Selected Room Group:", roomGroup.node()); // ตรวจสอบว่าเลือก group ถูกต้องหรือไม่

        if (!roomGroup.empty()) {
            // Calculate the bounding box of the roomGroup
            const roomGroupElement = roomGroup.node(); // Get the DOM element
            const roomGroupBBox = roomGroupElement.getBBox();

            // Use the bounding box dimensions
            const roomGroupWidth = roomGroupBBox.width;
            const roomGroupHeight = roomGroupBBox.height;

            // Calculate random coordinates within the roomGroup
            const randomX = roomGroupBBox.x + Math.random() * roomGroupWidth;
            const randomY = roomGroupBBox.y + Math.random() * roomGroupHeight;

            Vibrant.from(d.iiifthumburl).getPalette(function(err, palette) {
                if (!err) {
                    let hexColorsForThisCircle = [];
                    for (const swatch in palette) {
                        if (palette[swatch] && typeof palette[swatch].getHex === 'function') {
                            hexColorsForThisCircle.push(palette[swatch].getHex());
                        }
                    }

                    // Append a circle to the selected group
                    let circle = roomGroup.append("circle")
                        .attr('cx', randomX)
                        .attr('cy', randomY)
                        .attr('r', 2)
                        .attr('fill', getColorByArtType(d.TypesofArt))
                        .attr('data-colors', hexColorsForThisCircle.join(', '))
                        .attr('data-art-type', d.TypesofArt)
                        .attr('data-site', d.site);
                        
                    console.log('Circle ID:', index, 'Colors:', hexColorsForThisCircle);


                    // Add click event to open the modal
                    circle.on("click", function() {
                        // Modal logic
                        const modal = document.getElementById("myModal");
                        const modalImage = document.getElementById("modalImage");
                        const modalInfo = document.getElementById("modalInfo");
                        const span = document.getElementsByClassName("close")[0];

                        // Set modal content
                        modalImage.src = d.iiifthumburl; // Load the image
                        modalInfo.textContent = `Room: ${d.room}\nArt Type: ${d.TypesofArt}\nColors: ${hexColorsForThisCircle.join(', ')}`;
                        circle.on("click", function() {
                        let modalInfo = `${d.title_x}\nby: ${d.forwarddisplayname}\nYear: ${d.displaydate_x}`;
                        let site = d.site;
                        let description = d.description;
                        showModal(d.iiifthumburl, modalInfo, hexColorsForThisCircle, site, description);
                    });
                        // Display the modal
                        modal.style.display = "block";

                        // Close modal when clicking the close button or outside the modal
                        span.onclick = function() {
                            modal.style.display = "none";
                        }

                        window.onclick = function(event) {
                            if (event.target == modal) {
                                modal.style.display = "none";
                            }
                        }
                    });

                    // Log the color data for this circle
                    console.log('Circle ID:', index, 'Colors:', hexColorsForThisCircle);
                } else {
                    console.error("Error at index", index, "with URL:", d.iiifthumburl, "Error:", err);
                }
            });
        } else {
            console.warn("Room group not found for", d.room);
        }
    });
});
});

// Load the SVG file- East C
d3.xml('East Building, Concourse.svg').then(svgData => {

const svgContainer = document.getElementById("svg-container4");
svgContainer.appendChild(svgData.documentElement);


d3.csv('Finaldata.csv').then(function(data) {
    data.forEach(function(d, index) {
        console.log("Room ID from CSV:", d.room); // ตรวจสอบข้อมูลจาก CSV
        const roomGroup = d3.select(`#${d.room}`);
        console.log("Selected Room Group:", roomGroup.node()); // ตรวจสอบว่าเลือก group ถูกต้องหรือไม่

        if (!roomGroup.empty()) {
            // Calculate the bounding box of the roomGroup
            const roomGroupElement = roomGroup.node(); // Get the DOM element
            const roomGroupBBox = roomGroupElement.getBBox();

            // Use the bounding box dimensions
            const roomGroupWidth = roomGroupBBox.width;
            const roomGroupHeight = roomGroupBBox.height;

            // Calculate random coordinates within the roomGroup
            const randomX = roomGroupBBox.x + Math.random() * roomGroupWidth;
            const randomY = roomGroupBBox.y + Math.random() * roomGroupHeight;

            Vibrant.from(d.iiifthumburl).getPalette(function(err, palette) {
                if (!err) {
                    let hexColorsForThisCircle = [];
                    for (const swatch in palette) {
                        if (palette[swatch] && typeof palette[swatch].getHex === 'function') {
                            hexColorsForThisCircle.push(palette[swatch].getHex());
                        }
                    }

                    // Append a circle to the selected group
                    let circle = roomGroup.append("circle")
                        .attr('cx', randomX)
                        .attr('cy', randomY)
                        .attr('r', 2)
                        .attr('fill', getColorByArtType(d.TypesofArt))
                        .attr('data-colors', hexColorsForThisCircle.join(', '))
                        .attr('data-art-type', d.TypesofArt)
                        .attr('data-site', d.site);
                        
                    console.log('Circle ID:', index, 'Colors:', hexColorsForThisCircle);


                    // Add click event to open the modal
                    circle.on("click", function() {
                        // Modal logic
                        const modal = document.getElementById("myModal");
                        const modalImage = document.getElementById("modalImage");
                        const modalInfo = document.getElementById("modalInfo");
                        const span = document.getElementsByClassName("close")[0];

                        // Set modal content
                        modalImage.src = d.iiifthumburl; // Load the image
                        modalInfo.textContent = `Room: ${d.room}\nArt Type: ${d.TypesofArt}\nColors: ${hexColorsForThisCircle.join(', ')}`;
                        circle.on("click", function() {
                        let modalInfo = `${d.title_x}\nby: ${d.forwarddisplayname}\nYear: ${d.displaydate_x}`;
                        let site = d.site;
                        let description = d.description;
                        showModal(d.iiifthumburl, modalInfo, hexColorsForThisCircle, site, description);
                    });
                        // Display the modal
                        modal.style.display = "block";

                        // Close modal when clicking the close button or outside the modal
                        span.onclick = function() {
                            modal.style.display = "none";
                        }

                        window.onclick = function(event) {
                            if (event.target == modal) {
                                modal.style.display = "none";
                            }
                        }
                    });

                    // Log the color data for this circle
                    console.log('Circle ID:', index, 'Colors:', hexColorsForThisCircle);
                } else {
                    console.error("Error at index", index, "with URL:", d.iiifthumburl, "Error:", err);
                }
            });
        } else {
            console.warn("Room group not found for", d.room);
        }
    });
});
});

// Load the SVG file- East Ground
d3.xml('East Building, Ground Level.svg').then(svgData => {

const svgContainer = document.getElementById("svg-container5");
svgContainer.appendChild(svgData.documentElement);


d3.csv('Finaldata.csv').then(function(data) {
    data.forEach(function(d, index) {
        console.log("Room ID from CSV:", d.room); // ตรวจสอบข้อมูลจาก CSV
        const roomGroup = d3.select(`#${d.room}`);
        console.log("Selected Room Group:", roomGroup.node()); // ตรวจสอบว่าเลือก group ถูกต้องหรือไม่

        if (!roomGroup.empty()) {
            // Calculate the bounding box of the roomGroup
            const roomGroupElement = roomGroup.node(); // Get the DOM element
            const roomGroupBBox = roomGroupElement.getBBox();

            // Use the bounding box dimensions
            const roomGroupWidth = roomGroupBBox.width;
            const roomGroupHeight = roomGroupBBox.height;

            // Calculate random coordinates within the roomGroup
            const randomX = roomGroupBBox.x + Math.random() * roomGroupWidth;
            const randomY = roomGroupBBox.y + Math.random() * roomGroupHeight;

            Vibrant.from(d.iiifthumburl).getPalette(function(err, palette) {
                if (!err) {
                    let hexColorsForThisCircle = [];
                    for (const swatch in palette) {
                        if (palette[swatch] && typeof palette[swatch].getHex === 'function') {
                            hexColorsForThisCircle.push(palette[swatch].getHex());
                        }
                    }

                    // Append a circle to the selected group
                    let circle = roomGroup.append("circle")
                        .attr('cx', randomX)
                        .attr('cy', randomY)
                        .attr('r', 2)
                        .attr('fill', getColorByArtType(d.TypesofArt))
                        .attr('data-colors', hexColorsForThisCircle.join(', '))
                        .attr('data-art-type', d.TypesofArt)
                        .attr('data-site', d.site);
                        
                    console.log('Circle ID:', index, 'Colors:', hexColorsForThisCircle);


                    // Add click event to open the modal
                    circle.on("click", function() {
                        // Modal logic
                        const modal = document.getElementById("myModal");
                        const modalImage = document.getElementById("modalImage");
                        const modalInfo = document.getElementById("modalInfo");
                        const span = document.getElementsByClassName("close")[0];

                        // Set modal content
                        modalImage.src = d.iiifthumburl; // Load the image
                        modalInfo.textContent = `Room: ${d.room}\nArt Type: ${d.TypesofArt}\nColors: ${hexColorsForThisCircle.join(', ')}`;
                        circle.on("click", function() {
                        let modalInfo = `${d.title_x}\nby: ${d.forwarddisplayname}\nYear: ${d.displaydate_x}`;
                        let site = d.site;
                        let description = d.description;
                        showModal(d.iiifthumburl, modalInfo, hexColorsForThisCircle, site, description);
                    });
                        // Display the modal
                        modal.style.display = "block";

                        // Close modal when clicking the close button or outside the modal
                        span.onclick = function() {
                            modal.style.display = "none";
                        }

                        window.onclick = function(event) {
                            if (event.target == modal) {
                                modal.style.display = "none";
                            }
                        }
                    });

                    // Log the color data for this circle
                    console.log('Circle ID:', index, 'Colors:', hexColorsForThisCircle);
                } else {
                    console.error("Error at index", index, "with URL:", d.iiifthumburl, "Error:", err);
                }
            });
        } else {
            console.warn("Room group not found for", d.room);
        }
    });
});
});

// Load the SVG file- East M
d3.xml('East Building, Mezzanine.svg').then(svgData => {

const svgContainer = document.getElementById("svg-container6");
svgContainer.appendChild(svgData.documentElement);


d3.csv('Finaldata.csv').then(function(data) {
    data.forEach(function(d, index) {
        console.log("Room ID from CSV:", d.room); // ตรวจสอบข้อมูลจาก CSV
        const roomGroup = d3.select(`#${d.room}`);
        console.log("Selected Room Group:", roomGroup.node()); // ตรวจสอบว่าเลือก group ถูกต้องหรือไม่

        if (!roomGroup.empty()) {
            // Calculate the bounding box of the roomGroup
            const roomGroupElement = roomGroup.node(); // Get the DOM element
            const roomGroupBBox = roomGroupElement.getBBox();

            // Use the bounding box dimensions
            const roomGroupWidth = roomGroupBBox.width;
            const roomGroupHeight = roomGroupBBox.height;

            // Calculate random coordinates within the roomGroup
            const randomX = roomGroupBBox.x + Math.random() * roomGroupWidth;
            const randomY = roomGroupBBox.y + Math.random() * roomGroupHeight;

            Vibrant.from(d.iiifthumburl).getPalette(function(err, palette) {
                if (!err) {
                    let hexColorsForThisCircle = [];
                    for (const swatch in palette) {
                        if (palette[swatch] && typeof palette[swatch].getHex === 'function') {
                            hexColorsForThisCircle.push(palette[swatch].getHex());
                        }
                    }

                    // Append a circle to the selected group
                    let circle = roomGroup.append("circle")
                        .attr('cx', randomX)
                        .attr('cy', randomY)
                        .attr('r', 2)
                        .attr('fill', getColorByArtType(d.TypesofArt))
                        .attr('data-colors', hexColorsForThisCircle.join(', '))
                        .attr('data-art-type', d.TypesofArt)
                        .attr('data-site', d.site);
                        
                    console.log('Circle ID:', index, 'Colors:', hexColorsForThisCircle);


                    // Add click event to open the modal
                    circle.on("click", function() {
                        // Modal logic
                        const modal = document.getElementById("myModal");
                        const modalImage = document.getElementById("modalImage");
                        const modalInfo = document.getElementById("modalInfo");
                        const span = document.getElementsByClassName("close")[0];

                        // Set modal content
                        modalImage.src = d.iiifthumburl; // Load the image
                        modalInfo.textContent = `Room: ${d.room}\nArt Type: ${d.TypesofArt}\nColors: ${hexColorsForThisCircle.join(', ')}`;
                        circle.on("click", function() {
                        let modalInfo = `${d.title_x}\nby: ${d.forwarddisplayname}\nYear: ${d.displaydate_x}`;
                        let site = d.site;
                        let description = d.description;
                        showModal(d.iiifthumburl, modalInfo, hexColorsForThisCircle, site, description);
                    });
                        // Display the modal
                        modal.style.display = "block";

                        // Close modal when clicking the close button or outside the modal
                        span.onclick = function() {
                            modal.style.display = "none";
                        }

                        window.onclick = function(event) {
                            if (event.target == modal) {
                                modal.style.display = "none";
                            }
                        }
                    });

                    // Log the color data for this circle
                    console.log('Circle ID:', index, 'Colors:', hexColorsForThisCircle);
                } else {
                    console.error("Error at index", index, "with URL:", d.iiifthumburl, "Error:", err);
                }
            });
        } else {
            console.warn("Room group not found for", d.room);
        }
    });
});
});

// Load the SVG file- East U
d3.xml('East Building, Upper Level.svg').then(svgData => {

const svgContainer = document.getElementById("svg-container7");
svgContainer.appendChild(svgData.documentElement);


d3.csv('Finaldata.csv').then(function(data) {
    data.forEach(function(d, index) {
        console.log("Room ID from CSV:", d.room); // ตรวจสอบข้อมูลจาก CSV
        const roomGroup = d3.select(`#${d.room}`);
        console.log("Selected Room Group:", roomGroup.node()); // ตรวจสอบว่าเลือก group ถูกต้องหรือไม่

        if (!roomGroup.empty()) {
            // Calculate the bounding box of the roomGroup
            const roomGroupElement = roomGroup.node(); // Get the DOM element
            const roomGroupBBox = roomGroupElement.getBBox();

            // Use the bounding box dimensions
            const roomGroupWidth = roomGroupBBox.width;
            const roomGroupHeight = roomGroupBBox.height;

            // Calculate random coordinates within the roomGroup
            const randomX = roomGroupBBox.x + Math.random() * roomGroupWidth;
            const randomY = roomGroupBBox.y + Math.random() * roomGroupHeight;

            Vibrant.from(d.iiifthumburl).getPalette(function(err, palette) {
                if (!err) {
                    let hexColorsForThisCircle = [];
                    for (const swatch in palette) {
                        if (palette[swatch] && typeof palette[swatch].getHex === 'function') {
                            hexColorsForThisCircle.push(palette[swatch].getHex());
                        }
                    }

                    // Append a circle to the selected group
                    let circle = roomGroup.append("circle")
                        .attr('cx', randomX)
                        .attr('cy', randomY)
                        .attr('r', 2)
                        .attr('fill', getColorByArtType(d.TypesofArt))
                        .attr('data-colors', hexColorsForThisCircle.join(', '))
                        .attr('data-art-type', d.TypesofArt)
                        .attr('data-site', d.site);
                        
                    console.log('Circle ID:', index, 'Colors:', hexColorsForThisCircle);


                    // Add click event to open the modal
                    circle.on("click", function() {
                        // Modal logic
                        const modal = document.getElementById("myModal");
                        const modalImage = document.getElementById("modalImage");
                        const modalInfo = document.getElementById("modalInfo");
                        const span = document.getElementsByClassName("close")[0];

                        // Set modal content
                        modalImage.src = d.iiifthumburl; // Load the image
                        modalInfo.textContent = `Room: ${d.room}\nArt Type: ${d.TypesofArt}\nColors: ${hexColorsForThisCircle.join(', ')}`;
                        circle.on("click", function() {
                        let modalInfo = `${d.title_x}\nby: ${d.forwarddisplayname}\nYear: ${d.displaydate_x}`;
                        let site = d.site;
                        let description = d.description;
                        showModal(d.iiifthumburl, modalInfo, hexColorsForThisCircle, site, description);
                    });
                        // Display the modal
                        modal.style.display = "block";

                        // Close modal when clicking the close button or outside the modal
                        span.onclick = function() {
                            modal.style.display = "none";
                        }

                        window.onclick = function(event) {
                            if (event.target == modal) {
                                modal.style.display = "none";
                            }
                        }
                    });

                    // Log the color data for this circle
                    console.log('Circle ID:', index, 'Colors:', hexColorsForThisCircle);
                } else {
                    console.error("Error at index", index, "with URL:", d.iiifthumburl, "Error:", err);
                }
            });
        } else {
            console.warn("Room group not found for", d.room);
        }
    });
});
});

// Load the SVG file- East T
d3.xml('East Building, Tower.svg').then(svgData => {

const svgContainer = document.getElementById("svg-container8");
svgContainer.appendChild(svgData.documentElement);


d3.csv('Finaldata.csv').then(function(data) {
    data.forEach(function(d, index) {
        console.log("Room ID from CSV:", d.room); // ตรวจสอบข้อมูลจาก CSV
        const roomGroup = d3.select(`#${d.room}`);
        console.log("Selected Room Group:", roomGroup.node()); // ตรวจสอบว่าเลือก group ถูกต้องหรือไม่

        if (!roomGroup.empty()) {
            // Calculate the bounding box of the roomGroup
            const roomGroupElement = roomGroup.node(); // Get the DOM element
            const roomGroupBBox = roomGroupElement.getBBox();

            // Use the bounding box dimensions
            const roomGroupWidth = roomGroupBBox.width;
            const roomGroupHeight = roomGroupBBox.height;

            // Calculate random coordinates within the roomGroup
            const randomX = roomGroupBBox.x + Math.random() * roomGroupWidth;
            const randomY = roomGroupBBox.y + Math.random() * roomGroupHeight;

            Vibrant.from(d.iiifthumburl).getPalette(function(err, palette) {
                if (!err) {
                    let hexColorsForThisCircle = [];
                    for (const swatch in palette) {
                        if (palette[swatch] && typeof palette[swatch].getHex === 'function') {
                            hexColorsForThisCircle.push(palette[swatch].getHex());
                        }
                    }

                    // Append a circle to the selected group
                    let circle = roomGroup.append("circle")
                        .attr('cx', randomX)
                        .attr('cy', randomY)
                        .attr('r', 2)
                        .attr('fill', getColorByArtType(d.TypesofArt))
                        .attr('data-colors', hexColorsForThisCircle.join(', '))
                        .attr('data-art-type', d.TypesofArt)
                        .attr('data-site', d.site);
                        
                    console.log('Circle ID:', index, 'Colors:', hexColorsForThisCircle);


                    // Add click event to open the modal
                    circle.on("click", function() {
                        // Modal logic
                        const modal = document.getElementById("myModal");
                        const modalImage = document.getElementById("modalImage");
                        const modalInfo = document.getElementById("modalInfo");
                        const span = document.getElementsByClassName("close")[0];

                        // Set modal content
                        modalImage.src = d.iiifthumburl; // Load the image
                        modalInfo.textContent = `Room: ${d.room}\nArt Type: ${d.TypesofArt}\nColors: ${hexColorsForThisCircle.join(', ')}`;
                        circle.on("click", function() {
                        let modalInfo = `${d.title_x}\nby: ${d.forwarddisplayname}\nYear: ${d.displaydate_x}`;
                        let site = d.site;
                        let description = d.description;
                        showModal(d.iiifthumburl, modalInfo, hexColorsForThisCircle, site, description);
                    });
                        // Display the modal
                        modal.style.display = "block";

                        // Close modal when clicking the close button or outside the modal
                        span.onclick = function() {
                            modal.style.display = "none";
                        }

                        window.onclick = function(event) {
                            if (event.target == modal) {
                                modal.style.display = "none";
                            }
                        }
                    });

                    // Log the color data for this circle
                    console.log('Circle ID:', index, 'Colors:', hexColorsForThisCircle);
                } else {
                    console.error("Error at index", index, "with URL:", d.iiifthumburl, "Error:", err);
                }
            });
        } else {
            console.warn("Room group not found for", d.room);
        }
    });
});
});

document.getElementById('svg-container1').addEventListener('click', function() {
        window.location.href = 'Sculpture Garden.html';
    });

// Dot matrix
 d3.csv("Finaldata.csv").then(function (data) {
     // นับจำนวนครั้งที่ซ้ำของ TypesofArt
     let typeCounts = {};
    data.forEach(d => {
        if (!typeCounts[d.TypesofArt]) {
            typeCounts[d.TypesofArt] = 0;
        }
        typeCounts[d.TypesofArt] += 1;
    });

// Calculate dots per type    
const totalOccurrences = d3.sum(Object.values(typeCounts));
    const totalDots = 100;
    let typeDots = {};
    for (const artType in typeCounts) {
        typeDots[artType] = Math.round(totalDots * (typeCounts[artType] / totalOccurrences));
    }


    // Define colorMap here or ensure it's defined outside this snippet
    let colorMap = {
        "Sculpture": "red",
        "Painting": "blue",
        "Decorative Art": "green",
        "Drawing": "yellow",
        "New media": "pink",
        "Photograph": "purple",
        "Print": "grey",
        "Volume": "orange",
        // Add more art types and their colors here
    };

    // Create dot matrix
    const svgDotMatrix = d3.select("#dot-matrix-container svg");
    let row = 0, col = 0;
    const dotSize = 15;

    // Create dots
    for (const artType in typeDots) {
        const dots = typeDots[artType];
        for (let i = 0; i < dots; i++) {
            svgDotMatrix.append("circle")
                .attr("cx", col * (dotSize + 2) + (dotSize / 2))
                .attr("cy", row * (dotSize + 2) + (dotSize / 2))
                .attr("r", dotSize / 2)
                .attr("fill", colorMap[artType])
                .attr("stroke", "white");

            col++;
            if (col >= 10) {
                col = 0;
                row++;
            }
        }
    }

    // Create legends
 
d3.select("#legend").selectAll("div").remove(); // Clear the legend first

const totalTypesCount = d3.sum(Object.values(typeCounts)); // Calculate the total number of art types

Object.keys(typeDots).forEach(artType => {
    if (colorMap[artType]) {
        const percentage = (typeCounts[artType] / totalTypesCount * 100).toFixed(2); // Calculate the percentage
        d3.select("#legend").append("div")
            .style("display", "inline-block")
            .style("margin-right", "20px")
            .html(`
                <div style="display: inline-block; width: ${dotSize}px; height: ${dotSize}px; background-color: ${colorMap[artType]}; border-radius: 50%; margin-right: 5px;"></div>
                ${artType}: ${percentage}%
            `);
    }
});

});


</script>